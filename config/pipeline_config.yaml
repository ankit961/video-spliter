# Pipeline configuration
pipeline:
  mode: coverage  # coverage | highlights
  
  # Duration constraints - tighter for music/singing content
  min_clip_duration: 40.0  # Reduced from 45 to allow more granular cuts in music
  max_clip_duration: 55.0  # Reduced from 60 to force better break points
  
  # Coverage mode
  gap_penalty: 0.5
  max_gap: 5.0
  strict_coverage: false
  enforce_tail_coverage: true
  
  # Highlights mode
  max_clips: 10
  
  # Stitch behavior: forbidden_interior | preferred_cut | must_cut
  stitch_behavior: forbidden_interior

# Review settings
review:
  use_llm: true
  max_iterations: 3
  llm_model: gpt-4o-mini
  
  # Heuristic thresholds
  max_silence_ratio: 0.20
  max_speech_density_at_cut: 4.0
  min_boundary_confidence: 0.5

# Detector settings
detectors:
  use_vad: true
  use_transcript: true
  use_shot: true
  use_speaker: false
  
  # VAD config
  vad:
    min_pause_s: 0.35
    pause_boundary_at: start  # start | mid | end
  
  # Whisper config
  whisper:
    model_size: base  # tiny | base | small | medium | large-v3
    language: null  # null = auto-detect
    device: auto  # auto | cuda | cpu
  
  # Shot detection config
  shot:
    threshold: 0.5
    min_shot_length_s: 0.5
    use_pyscenedetect: true

# Scoring weights
scoring:
  # Boundary type weights
  boundary_weights:
    shot: 1.0
    stitch_mark: 0.95
    vad_pause: 0.95          # Increased from 0.9
    speaker_turn: 0.85
    sentence_end: 1.1        # Increased from 0.7 (sentence ends are ideal)
    energy_dip: 1.05         # Increased from 0.5 (critical for music!)
  
  # Bonuses/penalties
  base_clip_score: 10.0      # Increased from 8.0
  multi_signal_bonus: 0.5    # Increased from 0.3
  shot_energy_alignment_bonus: 0.8
  sentence_alignment_bonus: 1.5
  audio_abrupt_penalty: 0.5
  hook_bonus: 0.5
  silence_penalty_multiplier: 1.0
  high_speech_density_penalty: 0.5
  stitch_alignment_bonus: 0.5
  
  # Duration shaping
  target_duration: 50.0      # Adjusted for 40-55s range
  duration_penalty_per_second: 0.03

# Render settings
render:
  preview_resolution: 480p  # 360p | 480p | 720p
  preview_crf: 28
  final_crf: 18
  final_preset: medium
  audio_bitrate: 192k
  render_preview_only_for_borderline: true

# Output settings
output:
  directory: output
  filename_template: "clip_{index:03d}.mp4"

# Cache settings
cache:
  enabled: true
  directory: .cache
